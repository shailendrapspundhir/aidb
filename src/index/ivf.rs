// Partitioning logic for massive datasets